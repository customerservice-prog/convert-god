services:
  - type: web
    name: convert-god
    runtime: docker
    plan: starter
    healthCheckPath: /healthz
    envVars:
      - key: SERVICE_ROLE
        value: all

      - key: DJANGO_DEBUG
        value: "0"
      - key: DJANGO_ALLOWED_HOSTS
        value: "convert-god.onrender.com"
      - key: DJANGO_CSRF_TRUSTED_ORIGINS
        value: "https://convert-god.onrender.com"
      - key: DJANGO_SECRET_KEY
        generateValue: true

      - key: BASIC_AUTH_USER
        value: "admin"
      - key: BASIC_AUTH_PASS
        generateValue: true

      - key: SQLITE_PATH
        value: "/var/data/db.sqlite3"
      - key: MEDIA_ROOT
        value: "/var/data/media"

      - key: SIGNED_URL_EXPIRES
        value: "3600"
      - key: MAX_UPLOAD_BYTES
        value: "1073741824"

    # Persistent disk to store the sqlite DB + uploaded/converted files
    disk:
      name: convert-god-disk
      mountPath: /var/data
      sizeGB: 20
